<!doctype html>
<html lang="en" class="h-100">


{{element->header_app.html}}

<body class="d-flex flex-column h-100 menu-overlay">
    <nav class="navbar navbar-light fixed-top mt-3">
        <a id="return_link" class="navbar-brand" href="/index"><i style="font-size:30px;" class="bi bi-arrow-left-circle-fill"></i></a>
    </nav>
    <!-- screen loader -->
    {{element->loader.html}}
    <!-- Begin page content -->
    <main class="flex-shrink-0">
        <!-- Fixed navbar -->
        <header class="header">
            <div class="row">
                <div class="col-auto px-0">
                </div>
                <div class="text-left col align-self-center">
                    <h5>Profil</h5>
                </div>
                <div class="ml-auto col-auto align-self-center">

                </div>
            </div>
        </header>

        <!-- page content start -->


        <div class="container mt-4" id="profil_setting">
            <h6>Bateau</h6>
            <form id="boat_form" method="post" autocomplete="off">
                <div class="card mt-3 mb-4">
                    <div class="card-body">
                        <div class="form-group floating-form-group">
                            <div class="form-group floating-form-group">
                                <label class="text-muted" for="category-select">Numéro de place</label>
                                <select name="place_id" class="form-control" id="place-select">
                                </select>
                            </div>
                        </div>
                        <div class="form-group floating-form-group active">
                            <input id="name" name="name" type="text" class="form-control floating-input" required>
                            <label class="floating-label">Nom du bateau</label>
                        </div>
                        <div class="form-group floating-form-group active">
                            <input id="immatriculation" name="immatriculation" type="text" class="form-control floating-input" required>
                            <label class="floating-label">Immatriculation</label>
                        </div>
                        <div class="form-group floating-form-group active">
                            <input id="longueur" name="longueur" type="number" class="form-control floating-input" required>
                            <label class="floating-label">Longueur (Mètre)</label>
                        </div>
                        <div class="form-group floating-form-group active">
                            <input id="largeur" name="largeur" type="number" class="form-control floating-input" required>
                            <label class="floating-label">Largeur (Mètre)</label>
                        </div>
                        <div class="form-group floating-form-group active">
                            <input id="tirant_eau" name="tirant_eau" type="number" class="form-control floating-input" required>
                            <label class="floating-label">Tirant d'eau (Mètre)</label>
                        </div>
                        <input name="id" id="boat_id" type="text" class="form-control floating-input" required hidden>
                        <div id="updateBoatError"> </div>
                        <button type="button" class="btn btn-block btn-info btn-lg" onclick="sendBoatForm();">enregistrer</button>
                        <button id="delboatbutton" type="button" class="btn btn-block btn-danger btn-lg" onclick="deleteBoatForm();">supprimer</button>
                    </div>
                </div>
            </form>

            <button id="add_boat_button" type="button" class="btn btn-block btn-info btn-lg mb-4" onclick="activateBoatForm();" hidden>ajouter un bateau</button>

            <h6>Informations utilisateur</h6>
            <form id="profil_form" method="post" autocomplete="off">
                <div class="card mt-3 mb-4" id="account_info">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-12 col-md-6">
                                <div class="form-group floating-form-group active">
                                    <input id="first_name" name="first_name" type="text" class="form-control floating-input" value="">
                                    <label class="floating-label">Prénom</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 col-md-6">
                                <div class="form-group floating-form-group active">
                                    <input id="last_name" name="last_name" type="text" class="form-control floating-input" value="">
                                    <label class="floating-label">Nom</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 col-md-6">
                                <div class="form-group floating-form-group active">
                                    <input id="email" name="email" type="email" class="form-control floating-input" value="" autocomplete="off">
                                    <label class="floating-label">Email</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 col-md-6">
                                <div class="row">
                                    <div class="col-3">
                                        <div class="form-group floating-form-group active">
                                            <input id="prefix" name="prefix" type="text" class="form-control floating-input" value="" required>
                                            <label class="floating-label">Préfixe</label>
                                        </div>
                                    </div>
                                    <div class="col-9">
                                        <div class="form-group floating-form-group active">
                                            <input id="phone" name="phone" type="tel" class="form-control floating-input" value="" required>
                                            <label class="floating-label">Téléphone mobile</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <h6>Preferences</h6>
                <div class="card mt-3 mb-4">
                    <div class="card-body px-0">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item border-color">
                                <div class="row">
                                    <div class="col-auto pr-0 align-self-center text-right">
                                        <div class="custom-control custom-switch">
                                            <input type="checkbox" class="custom-control-input" id="customSwitch1" checked="">
                                            <label class="custom-control-label" for="customSwitch1"></label>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <h6 class="text-dark mb-1">Notifications email</h6>
                                        <p class="text-secondary mb-0 small">Recevoir les notifications par Email</p>
                                    </div>
                                </div>
                            </li>
                            <li class="list-group-item border-color">
                                <div class="row">
                                    <div class="col-auto pr-0 align-self-center text-right">
                                        <div class="custom-control custom-switch">
                                            <input type="checkbox" class="custom-control-input" id="customSwitch4" checked="">
                                            <label class="custom-control-label" for="customSwitch4"></label>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <h6 class="text-dark mb-1">Notifications SMS</h6>
                                        <p class="text-secondary mb-0 small">Recevoir les notifications par sms</p>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>

                <h6 class="mt-3">Changer mot de passe</h6>
                <div class="card mt-3 mb-4">
                    <div class="card-body">
                        <div class="row ">
                            <div class="col-12 col-md-6">
                                <div class="form-group floating-form-group">
                                    <input id="current_password" name="current_password" type="password" class="form-control floating-input" value="">
                                    <label class="floating-label">Mot de passe actuel</label>
                                </div>
                            </div>
                            <div class="col-12 col-md-6">
                                <div class="form-group floating-form-group">
                                    <input id="password" name="password" type="password" class="form-control floating-input" value="">
                                    <label class="floating-label">Nouveau mot de passe</label>
                                </div>
                            </div>
                            <div class="col-12 col-md-6">
                                <div class="form-group floating-form-group mb-0">
                                    <input id="password_confirm" name="password_confirm" type="password" class="form-control floating-input" value="">
                                    <label class="floating-label">Confirmer nouveau mot de passe</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="updateError"> </div>
                <button type="button" class="btn btn-block btn-info btn-lg" onclick="sendForm();">valider</button>
            </form>
            <button id="validate_button" type="button" class="btn btn-block btn-danger btn-lg" onclick="disconnect();">Déconnexion</button>

        </div>
        <br />
        <br />
        <div class="container py-3">
            {{element->navbar.html}}
        </div>
    </main>
    <!-- color settings style switcher    <button type="button" class="btn btn-info colorsettings">
        <span class="text-white">
            <svg xmlns='http://www.w3.org/2000/svg' class="icon-size-24" viewBox='0 0 512 512'>
                <title>ionicons-v5-m</title>
                <path d='M430.11,347.9c-6.6-6.1-16.3-7.6-24.6-9-11.5-1.9-15.9-4-22.6-10-14.3-12.7-14.3-31.1,0-43.8l30.3-26.9c46.4-41,46.4-108.2,0-149.2-34.2-30.1-80.1-45-127.8-45-55.7,0-113.9,20.3-158.8,60.1-83.5,73.8-83.5,194.7,0,268.5,41.5,36.7,97.5,55,152.9,55.4h1.7c55.4,0,110-17.9,148.8-52.4C444.41,382.9,442,359,430.11,347.9Z' style='fill:none;stroke:#000;stroke-miterlimit:10;stroke-width:32px' />
                <circle cx='144' cy='208' r='32' />
                <circle cx='152' cy='311' r='32' />
                <circle cx='224' cy='144' r='32' />
                <circle cx='256' cy='367' r='48' />
                <circle cx='328' cy='144' r='32' />
            </svg>
        </span>
    </button>
         -->

    <div class="sidebar-right">
        <div class="selectoption">
            <input type="checkbox" id="darklayout" name="darkmode">
            <label for="darklayout">Dark</label>
        </div>
        <div class="selectoption mb-0">
            <input type="checkbox" id="rtllayout" name="layoutrtl">
            <label for="rtllayout">RTL</label>
        </div>
        <hr>
        <div class="colorselect">
            <input type="radio" id="templatecolor1" name="sidebarcolorselect">
            <label for="templatecolor1" class="bg-dark-blue" data-title="dark-blue"></label>
        </div>
        <div class="colorselect">
            <input type="radio" id="templatecolor2" name="sidebarcolorselect">
            <label for="templatecolor2" class="bg-dark-purple" data-title="dark-purple"></label>
        </div>
        <div class="colorselect">
            <input type="radio" id="templatecolor4" name="sidebarcolorselect">
            <label for="templatecolor4" class="bg-dark-gray" data-title="dark-gray"></label>
        </div>
        <div class="colorselect">
            <input type="radio" id="templatecolor6" name="sidebarcolorselect">
            <label for="templatecolor6" class="bg-dark-brown" data-title="dark-brown"></label>
        </div>
        <div class="colorselect">
            <input type="radio" id="templatecolor3" name="sidebarcolorselect">
            <label for="templatecolor3" class="bg-maroon" data-title="maroon"></label>
        </div>
        <div class="colorselect">
            <input type="radio" id="templatecolor5" name="sidebarcolorselect">
            <label for="templatecolor5" class="bg-dark-pink" data-title="dark-pink"></label>
        </div>
        <div class="colorselect">
            <input type="radio" id="templatecolor8" name="sidebarcolorselect">
            <label for="templatecolor8" class="bg-red" data-title="red"></label>
        </div>
        <div class="colorselect">
            <input type="radio" id="templatecolor13" name="sidebarcolorselect">
            <label for="templatecolor13" class="bg-amber" data-title="amber"></label>
        </div>
        <div class="colorselect">
            <input type="radio" id="templatecolor7" name="sidebarcolorselect">
            <label for="templatecolor7" class="bg-dark-green" data-title="dark-green"></label>
        </div>
        <div class="colorselect">
            <input type="radio" id="templatecolor11" name="sidebarcolorselect">
            <label for="templatecolor11" class="bg-teal" data-title="teal"></label>
        </div>
        <div class="colorselect">
            <input type="radio" id="templatecolor12" name="sidebarcolorselect">
            <label for="templatecolor12" class="bg-skyblue" data-title="skyblue"></label>
        </div>
        <div class="colorselect">
            <input type="radio" id="templatecolor10" name="sidebarcolorselect">
            <label for="templatecolor10" class="bg-blue" data-title="blue"></label>
        </div>
        <div class="colorselect">
            <input type="radio" id="templatecolor9" name="sidebarcolorselect">
            <label for="templatecolor9" class="bg-purple" data-title="purple"></label>
        </div>
        <div class="colorselect">
            <input type="radio" id="templatecolor14" name="sidebarcolorselect">
            <label for="templatecolor14" class="bg-gray" data-title="gray"></label>
        </div>

    </div>


    <!-- Required jquery and libraries -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- cookie js -->
    <script src="js/jquery.cookie.js"></script>

    <!-- Swiper slider  -->
    <script src="vendor/swiper/js/swiper.min.js"></script>

    <!-- Masonry js -->
    <script src="vendor/masonry/masonry.pkgd.min.js"></script>

    <!-- Customized jquery file  -->
    <script src="js/main.js"></script>
    <script src="js/color-scheme-demo.js"></script>

    <!-- page level custom script -->
    <script>
        function activateBoatForm() {
            document.getElementById("boat_form").hidden = false;
            document.getElementById("add_boat_button").hidden = true;
            document.getElementById("delboatbutton").hidden = true;
            getPlaces();
        }
        "use strict"
        $(window).on('load', function () {
            if (localStorage['entity_id'] == '4eqv44307K')
                document.getElementById('validate_button').setAttribute("style", "background-color: #FB9101;");

            var swiper = new Swiper('.swiper-container', {
                pagination: {
                    el: '.swiper-pagination',
                },
            });

            var formData = new FormData();
            formData.append("token", localStorage["token"])
            fetch("/api/getuser", { method: "post", body: formData }).then(response => response.json()).then(_data => {
                console.log(_data);
                if (_data.success) {
                    var user = _data.data;
                    document.getElementById("first_name").value = user.first_name;
                    document.getElementById("last_name").value = user.last_name;
                    document.getElementById("email").value = user.email;
                    document.getElementById("phone").value = user.phone;
                    document.getElementById("prefix").value = user.prefix;
                    //api/get / userboats
                    fetch("/api/get/userboats?user_id=" + user.id + "&harbour_id=" + user.harbourid, { method: "GET" }).then(response => response.json()).then(_data => {
                        if (_data.success) {
                            const boat = _data.data[0];
                            document.getElementById("boat_id").value = boat.id;
                            document.getElementById("name").value = boat.name;
                            document.getElementById("immatriculation").value = boat.immatriculation;
                            document.getElementById("longueur").value = boat.longueur;
                            document.getElementById("largeur").value = boat.largeur;
                            document.getElementById("tirant_eau").value = boat.tirant_eau;
                            getPlaces(boat.place_id);
                        } else {
                            document.getElementById("boat_form").hidden = true;
                            document.getElementById("add_boat_button").hidden = false;
                        }
                    }).catch((error) => {
                        console.log(error);
                    });
                } else {
                    document.getElementById("profil_form").hidden = true;
                }
            }).catch((error) => {
                console.log(error);
            });
        });


        function disconnect() {
            localStorage.removeItem("harbourid");
            localStorage.removeItem("harbourname");
            localStorage.removeItem("user");
            localStorage.removeItem("token");
            localStorage.removeItem('onesignal_userid');
            window.location.href = ("/?entity=" + localStorage['entity_id']);
        }


        function sendForm() {
            var form = document.getElementById("profil_form");
            var formData = new FormData(form);
            formData.append("token", localStorage["token"])

            fetch("/api/updateuser", { method: "post", body: formData }).then(response => response.json()).then(_data => {
                console.log(_data);
                if (_data.success) {
                    console.log(_data);
                    window.location.reload();
                } else {
                    if (document.getElementById("error"))
                        document.getElementById("updateError").removeChild(document.getElementById("error"));

                    document.getElementById("updateError").insertAdjacentHTML("beforeend", '<div id="error" class="alert alert-danger">ERREUR : ' + _data.message + '</div>');
                }
            }).catch((error) => {
                console.log(error);
            });
        }

        function sendBoatForm() {

            var form = document.getElementById("boat_form");
            var formData = new FormData(form);
            formData.append("token", localStorage["token"])
            formData.append("harbour", localStorage["harbourid"])

            fetch("/api/updateboat", { method: "post", body: formData }).then(response => response.json()).then(_data => {
                console.log(_data);
                if (_data.success) {
                    console.log(_data);
                    window.location.reload();
                } else {
                    if (document.getElementById("errorBoat"))
                        document.getElementById("updateBoatError").removeChild(document.getElementById("error"));

                    document.getElementById("updateBoatError").insertAdjacentHTML("beforeend", '<div id="errorBoat" class="alert alert-danger">ERREUR : ' + _data.message + '</div>');
                }
            }).catch((error) => {
                console.log(error);
            });
        }
        function deleteBoatForm() {

            var form = document.getElementById("boat_form");
            var formData = new FormData(form);
            formData.append("token", localStorage["token"])
            fetch("/api/deleteBoat", { method: "post", body: formData }).then(response => response.json()).then(_data => {
                console.log(_data);
                if (_data.success) {
                    console.log(_data);
                    window.location.reload();
                } else {
                    if (document.getElementById("errorBoat"))
                        document.getElementById("updateBoatError").removeChild(document.getElementById("errorBoat"));

                    document.getElementById("updateBoatError").insertAdjacentHTML("beforeend", '<div id="error" class="alert alert-danger">ERREUR : ' + _data.message + '</div>');
                }
            }).catch((error) => {
                console.log(error);
            });
        }
        function getPlaces(_place_id) {

            fetch("/api/places?harbour_id=" + localStorage["harbourid"], { method: "GET" }).then(response => response.json()).then(_data => {
                console.log(_data);
                var places = _data.data;
                document.getElementById('place-select').innerHTML = "";
                for (var i = 0; i < places.length; i++) {
                    if (_place_id) {
                        if (places.id == _place_id)
                            document.getElementById('place-select').innerHTML += '<option value="' + places[i].id + '" selected>' + places[i].number + '</option>';
                        else
                            document.getElementById('place-select').innerHTML += '<option value="' + places[i].id + '" >' + places[i].number + '</option>';
                    } else {
                        document.getElementById('place-select').innerHTML += '<option value="' + places[i].id + '" >' + places[i].number + '</option>';
                    }
                }
            }).catch((e) => console.error(e));
        }
    </script>

    <style>
        @font-face {
            font-family: 'Poppins Regular';
            font-style: normal;
            font-weight: normal;
            src: local('Poppins Regular'), url('/library/Poppins-Regular.woff') format('woff');
        }

        * {
            font-family: 'Poppins Regular' !important;
        }

        body {
            font-family: 'Poppins Regular' !important;
        }
    </style>
    {{element->footer_app.html}}

</body>
<!-- Mirrored from maxartkiller.com/website/Nauticspot/setting.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 31 Aug 2020 16:49:14 GMT -->
</html>
